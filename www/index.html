<html>
    <head>
        <title>Bitches</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="jquery-1.10.1.min.js"></script>
        <script src="socket.io.js"></script>
        <script src="index.js"></script>
        <script src="jquery.min.js" type="text/javascript"></script>
        <script src="jquery-ui.min.js" type="text/javascript"></script>
        <script src="farbtastic.js" type="text/javascript"></script>
     
        <link rel="stylesheet" type="text/css" href="jquery-ui.css" media = "all"/>
        <link rel="stylesheet" href="farbtastic.css" type="text/css" />
        <style type="text/css">

    #red .ui-slider-range,#red .ui-slider-handle{
        background: #ef2929;
    }
    #green .ui-slider-range,#green .ui-slider-handle{
        background: #8ae234;
    }
    #blue .ui-slider-range,#blue .ui-slider-handle{
        background: #729fcf;
    }
    #swatch{
        width: 180px;
        height: 180px;
        background-image:none;
        float:right;
        margin:6px 20px 0px 0px;
        border:none;
        background-color:black;
    }
    #sliders{
        width:500px;
    }
    #colorpicker{
        float:left;
        margin:0px 0px 0px 20px;
    }
    #red,#green,#blue{
        margin:10px 0px 0px 0px;
    }
    
    </style>
         <script type = "text/javascript">
        $(document).ready(function(){
            var colorPicker = $.farbtastic("#colorpicker");
            colorPicker.linkTo(pickerUpdate);
            $("#red,#green,#blue").slider({
                orientation:"horizontal",
                range:"min",
                max:255,
                slide:sliderUpdate
            });
            function sliderUpdate() {
                var red=$("#red").slider("value");
                var green=$("#green").slider("value");
                var blue=$("#blue").slider("value");
                var hex=hexFromRGB(red,green,blue);
                colorPicker.setColor("#"+hex);
            }   
            function hexFromRGB(r,g,b){
                var hex = [r.toString(16),g.toString(16),b.toString(16)];
                $.each(hex,function(nr,val){
                    if(val.length===1){
                        hex[nr]="0"+val;
                    }
                });
                return hex.join("").toUpperCase();
            }
            function pickerUpdate(color){
                $("#swatch").css("background-color",color);
                if(colorPicker.hsl[2]>0.5){
                    $("#innerswatch").css("color","#000000");     
                }
                else{
                    $("#innerswatch").css("color","#ffffff");   
                }
                $("#innerswatch").html(color.toUpperCase())
                var red = parseInt(color.substring(1,3),16);
                var green = parseInt(color.substring(3,5),16);
                var blue = parseInt(color.substring(5,7),16);   
                $("#red").slider("value",red);
                $("#green").slider("value",green);
                $("#blue").slider("value",blue);        
            }
           
            var socket = io.connect('http://paseolights.local:80');

            function sendColors(){
                var red=$("#red").slider("value");
                var green=$("#green").slider("value");
                var blue=$("#blue").slider("value");
                alert(red);
                setTimeout(sendCMD(red), 15);
                setTimeout(sendCMD(green), 30);
                setTimeout(sendCMD(blue), 45);
            }

            function sendCMD(cmd){
                socket.emit('command', cmd);
}

$(document).on("click", ".click-led", function() {
    sendCMD($(this).val());

});
$(document).on("click", ".pick-color", function() {
    sendCMD($(this).val());
    sendColors();
});
        });
     </script>


    </head>
    <body>
        <h1>Bitches</h1>
        <br>
        <div id = "sliders">
        <div id="colorpicker"></div>
        <div id="swatch" class="ui-widget-content ui-corner-all">
            <div id="innerswatch">#000000</div>
        </div>
        <div style = "clear:both"></div>
        <div id="red"></div>
        <div id="green"></div>
        <div id="blue"></div>
        </div>
        <div>
            <button type="button" class="click-led" id="led-off" value="0">Turn Off</button>
            <button type="button" class="pick-color" id="led-sc" value="1">Solid Color</button>
            <button type="button" class="click-led" id="led-rainbow" value="2">Rainbow</button>
            <button type="button" class="click-led" id="led-lightning" value="3">Random Color Lightning</button>
            <button type="button" class="click-led" id="led-tc" value="4">Random Color Theater Chase</button>
            <button type="button" class="click-led" id="led-cylon" value="5">Random Color Cylon</button>
        </div>
    </body>
</html>
